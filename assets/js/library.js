(function (root) {

  var _ = root._ || require('../vendor/underscore');
  
  var A = (root.allong && root.allong.es) || require('../vendor/allong.es.browser').allong.es;

  var QuadTree = root.QuadTree || require('./quad-tree').QuadTree,
      Cell     = root.Cell     || require('./quad-tree').Cell

  if (QuadTree.prototype.toJSON === undefined) {
    require('./json');
  }

  QuadTree.Library || (QuadTree.Library = {});

  A.extend(QuadTree.Library, {

    Block: A.memoized( function () { return QuadTree.fromString(
      '**',
      '**'
    ); }),

    Beehive: A.memoized( function () { return QuadTree.fromString(
      '........',
      '........',
      '....*...',
      '...*.*..',
      '...*.*..',
      '....*...',
      '........',
      '........'
    ); }),

    Glider: A.memoized( function () { return QuadTree.fromString(
      '........',
      '........',
      '........',
      '...***..',
      '.....*..',
      '....*...',
      '........',
      '........'
    ); }),

    BlockLayingSwitchEngine: A.memoized( function () { return QuadTree.fromString(
      '........',
      '......*.',
      '....*.**',
      '....*.*.',
      '....*...',
      '..*.....',
      '*.*.....',
      '........'
    ); }),

    NoahsArk: A.memoized( function () { return QuadTree.fromString(
      '................',
      '...........*.*..',
      '..........*.....',
      '...........*..*.',
      '.............***',
      '................',
      '................',
      '................',
      '................',
      '................',
      '..*.............',
      '.*.*............',
      '................',
      '.*..*...........',
      '...**...........',
      '....*...........'
    ); }),

    GosperGliderGun: A.memoized( function () { return QuadTree.fromString(
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '.....................................*..........................',
      '...................................*.*..........................',
      '.........................**......**............**...............',
      '........................*...*....**............**...............',
      '.............**........*.....*...**.............................',
      '.............**........*...*.**....*.*..........................',
      '.......................*.....*.......*..........................',
      '........................*...*...................................',
      '.........................**.....................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................',
      '................................................................'
    ); }),

    Rabbits: A.memoized( function () { return QuadTree.fromString(
      '........',
      '........',
      '........',
      '.*...***',
      '.***..*.',
      '..*.....',
      '........',
      '........'
    ); }),

  });
  
  A.extendClass(Cell, {
    rotate: function () {
      return this;
    }
  });
  
  A.extendClass(QuadTree, {
    rotate: function () {
      return new QuadTree([
        this.sw().rotate(),
        this.nw().rotate(),
        this.ne().rotate(),
        this.se().rotate()
      ]);
    }
  });

})(this);